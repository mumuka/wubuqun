(function(e){e.fn.touchSlider=function(t){function h(){function e(){p(),setTimeout(d),wubuslidersettime=setTimeout(e,r.timeinterval)}wubuslidersettime=setTimeout(e,r.timeinterval)}function p(t,i){if(u.notouch){u.leftrighttouch||(u.notouch=!1);return}var t=typeof t=="number"?t:0,i=typeof i=="number"?i:0;if(t!==0){u.notouch=!0,e(n[u.index])[0].addEventListener("webkitTransitionEnd",o,!1);function o(){e(n[u.index])[0].removeEventListener("webkitTransitionEnd",o,!1),u.notouch=!1}}e(n[u.index]).css({transform:"translate3d("+(0+i)+"px,"+0+"px,"+0+"px)",transition:t+"s ease-out"}),(t===0||u.direction>=0)&&e(n[u.prevpic]).css({transform:"translate3d("+(-s+i)+"px,"+0+"px,"+0+"px)",transition:t+"s ease-out"}),(t===0||u.direction<=0)&&e(n[u.nextpic]).css({transform:"translate3d("+(s+i)+"px,"+0+"px,"+0+"px)",transition:t+"s ease-out"}),t!=0&&r.sliderpoint&&u.direction!=0&&(e(".currentsliderpoint").css({"background-color":r.sliderpointbgcolor}).removeClass("currentsliderpoint"),e(c[u.index]).addClass("currentsliderpoint").css({"background-color":r.sliderpointcolor}))}function d(){u.init(u.index+1),p(r.animatetime/1e3)}function v(){u.init(u.index-1),p(r.animatetime/1e3)}function m(){u.init(),p(r.animatetime/2e3)}function g(e){r.automatic&&clearTimeout(wubuslidersettime);var t=e.originalEvent.changedTouches[0];u.start[0]=t.clientX,u.start[1]=t.clientY,u.starttime=e.timeStamp,p()}function y(e){if(u.notouch)return;var t=e.originalEvent.changedTouches[0];u.now[0]=t.clientX,u.now[1]=t.clientY,u.nowtime=e.timeStamp;var n=u.now[0]-u.start[0],r=u.now[1]-u.start[1],i=u.nowtime-u.starttime;if(i<400&&!u.leftrighttouch)if(Math.abs(n)>8&&Math.abs(r)<8)e.preventDefault(),u.leftrighttouch=!0;else if(Math.abs(n)<8&&Math.abs(r)>8){u.notouch=!0;if(navigator.userAgent.match(/Android/i)){try{clearTimeout(clearnotoucht)}catch(e){}clearnotoucht=setTimeout(s,500);function s(){u.notouch=!1}}return}var o=n;p(0,o)}function b(t){var n=t.originalEvent.changedTouches[0];u.end[0]=n.clientX,u.end[1]=n.clientY,u.endtime=t.timeStamp;var i=u.end[0]-u.start[0],s=u.end[1]-u.start[1],o=u.endtime-u.starttime;if(o<250&&Math.abs(i)<8&&Math.abs(s)<8){window.location.href=e(".sliderbox").find("a:eq("+u.index+")").attr("href");return}u.init(),i>30&&u.leftrighttouch?v():i<-30&&u.leftrighttouch?d():Math.abs(i)<=10?(p(),u.notouch=!0):m(),u.leftrighttouch=!1,r.automatic&&h()}var n=e(this).children();if(n.size()==1)return;var r={circulate:!1,automatic:!1,sliderpoint:!0,sliderpointwidth:8,sliderpointcolor:"#aaa",sliderpointbgcolor:"#eee",timeinterval:3e3,animatetime:300};if(typeof t!="undefined")for(arg in t)typeof r[arg]==typeof t[arg]&&(r[arg]=t[arg]);var i=n.size(),s=e(this).width(),o=e(this).height(),u={index:0,notouch:!1,leftrighttouch:!1,starttime:0,nowtime:0,endtime:0,start:[0,0],now:[0,0],end:[0,0],direction:0,init:function(e){typeof e=="number"?e<0?(this.direction=-1,this.index=i-1):e>=i?(this.direction=1,this.index=0):(this.direction=e>this.index?1:-1,this.index=e):this.direction=0;var t=u.index-1;this.prevpic=t>=0?t:i-1;var n=u.index+1;this.nextpic=n<i?n:0}};u.init(),e(this).css({position:"relative"}).find("a").click(function(e){e.preventDefault()}),n.each(function(t){var n=t==0?0:1;e(this).css({width:s,transform:"translate3d("+s*n+"px,"+0+"px,"+0+"px)",transition:"0s ease-out",position:"absolute"})});if(r.sliderpoint){e(this).append(e("<ul class='pointlist'><li class='currentsliderpoint'></li></ul>"));for(var a=1;a<i;a++)e(".pointlist").append(e("<li></li>"));var f=Math.ceil(r.sliderpointwidth/5),l=f*2+r.sliderpointwidth,c=e(this).find(".pointlist").find("li");e(this).find(".pointlist").css({width:l*i,height:l,position:"absolute",transform:"translate3d(0,"+(o/2-r.sliderpointwidth)+"px,1px)",padding:0,top:0,left:0,right:0,bottom:0,margin:"auto"}),c.css({"list-style":"none",width:r.sliderpointwidth,height:r.sliderpointwidth,"border-radius":r.sliderpointwidth,margin:f,"float":"left","background-color":r.sliderpointbgcolor,transition:r.animatetime/1e3+"s ease-out"}),e(".currentsliderpoint").css({"background-color":r.sliderpointcolor})}return e(this).bind("touchstart",function(e){g(e)}),e(this).bind("touchmove",function(e){y(e)}),e(this).bind("touchend",function(e){b(e)}),r.automatic&&h(),e(this)}})(typeof jQuery!="undefined"?jQuery:window.Zepto);